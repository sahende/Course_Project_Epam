{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Victus/Desktop/Course_Project/lib/authClient.ts"],"sourcesContent":["const AuthClient = {\r\n  async login(email: string, password: string) {\r\n    const res = await fetch('http://localhost:3000/api/auth/login', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      credentials: 'include',\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n    if (!res.ok) {\r\n      let body: any;\r\n      try { body = await res.json(); } catch { body = await res.text(); }\r\n      const msg = body && (body.error || body.message) ? (body.error || body.message) : JSON.stringify(body);\r\n      throw new Error(msg || `Login failed (${res.status})`);\r\n    }\r\n    return res.json();\r\n  },\r\n  async register(email: string, password: string) {\r\n    const res = await fetch('http://localhost:3000/api/auth/register', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ email, password }),\r\n    });\r\n    if (!res.ok) {\r\n      let body: any;\r\n      try { body = await res.json(); } catch { body = await res.text(); }\r\n      const msg = body && (body.error || body.message) ? (body.error || body.message) : JSON.stringify(body);\r\n      throw new Error(msg || `Register failed (${res.status})`);\r\n    }\r\n    return res.json();\r\n  },\r\n  async logout() {\r\n    try {\r\n      if (typeof window === 'undefined') return;\r\n      const token = window.localStorage.getItem('accessToken');\r\n      if (!token) return;\r\n      // decode JWT to get sub (userId)\r\n      let userId: string | null = null;\r\n      try {\r\n        const parts = token.split('.');\r\n        if (parts.length === 3) {\r\n          const payload = JSON.parse(atob(parts[1].replace(/-/g, '+').replace(/_/g, '/')));\r\n          userId = payload?.sub ?? null;\r\n        }\r\n      } catch {\r\n        userId = null;\r\n      }\r\n\r\n      await fetch('http://localhost:3000/api/auth/logout', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ userId }),\r\n      });\r\n\r\n      // clear client-side session\r\n      window.localStorage.removeItem('accessToken');\r\n      window.localStorage.removeItem('userEmail');\r\n    } catch {\r\n      // ignore errors; ensure session cleared\r\n      if (typeof window !== 'undefined') {\r\n        window.localStorage.removeItem('accessToken');\r\n        window.localStorage.removeItem('userEmail');\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nexport default AuthClient;\r\n"],"names":[],"mappings":";;;;AAAA,MAAM,aAAa;IACjB,MAAM,OAAM,KAAa,EAAE,QAAgB;QACzC,MAAM,MAAM,MAAM,MAAM,wCAAwC;YAC9D,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,aAAa;YACb,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;YAAS;QACzC;QACA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,IAAI;YACJ,IAAI;gBAAE,OAAO,MAAM,IAAI,IAAI;YAAI,EAAE,OAAM;gBAAE,OAAO,MAAM,IAAI,IAAI;YAAI;YAClE,MAAM,MAAM,QAAQ,CAAC,KAAK,KAAK,IAAI,KAAK,OAAO,IAAK,KAAK,KAAK,IAAI,KAAK,OAAO,GAAI,KAAK,SAAS,CAAC;YACjG,MAAM,IAAI,MAAM,OAAO,CAAC,cAAc,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;QACvD;QACA,OAAO,IAAI,IAAI;IACjB;IACA,MAAM,UAAS,KAAa,EAAE,QAAgB;QAC5C,MAAM,MAAM,MAAM,MAAM,2CAA2C;YACjE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;YAAS;QACzC;QACA,IAAI,CAAC,IAAI,EAAE,EAAE;YACX,IAAI;YACJ,IAAI;gBAAE,OAAO,MAAM,IAAI,IAAI;YAAI,EAAE,OAAM;gBAAE,OAAO,MAAM,IAAI,IAAI;YAAI;YAClE,MAAM,MAAM,QAAQ,CAAC,KAAK,KAAK,IAAI,KAAK,OAAO,IAAK,KAAK,KAAK,IAAI,KAAK,OAAO,GAAI,KAAK,SAAS,CAAC;YACjG,MAAM,IAAI,MAAM,OAAO,CAAC,iBAAiB,EAAE,IAAI,MAAM,CAAC,CAAC,CAAC;QAC1D;QACA,OAAO,IAAI,IAAI;IACjB;IACA,MAAM;QACJ,IAAI;YACF;;YACA,MAAM,QAAQ,OAAO,YAAY,CAAC,OAAO,CAAC;YAC1C,IAAI,CAAC,OAAO;YACZ,iCAAiC;YACjC,IAAI,SAAwB;YAC5B,IAAI;gBACF,MAAM,QAAQ,MAAM,KAAK,CAAC;gBAC1B,IAAI,MAAM,MAAM,KAAK,GAAG;oBACtB,MAAM,UAAU,KAAK,KAAK,CAAC,KAAK,KAAK,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,MAAM;oBAC1E,SAAS,SAAS,OAAO;gBAC3B;YACF,EAAE,OAAM;gBACN,SAAS;YACX;YAEA,MAAM,MAAM,yCAAyC;gBACnD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;gBAAO;YAChC;YAEA,4BAA4B;YAC5B,OAAO,YAAY,CAAC,UAAU,CAAC;YAC/B,OAAO,YAAY,CAAC,UAAU,CAAC;QACjC,EAAE,OAAM;YACN,wCAAwC;YACxC,wCAAmC;gBACjC,OAAO,YAAY,CAAC,UAAU,CAAC;gBAC/B,OAAO,YAAY,CAAC,UAAU,CAAC;YACjC;QACF;IACF;AACF;uCAEe"}}]
}